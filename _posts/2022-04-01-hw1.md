---
layout: post
title: Homework 1
---
### 4.Create Two More Interesting Figures

#### (1)The Plot Question: How does the temperature of each city in a country monthly change?


```python
def f(country, year):
    conn = sqlite3.connect("temps.db")
    cmd = \
    """
    SELECT S.name, C.name , T.year,  T.temp, T.month
    FROM temperatures T
    LEFT JOIN stations S ON T.id = S.id
    LEFT JOIN countries C ON SUBSTRING(S.id,1,2) = C."fips_10-4"
    WHERE C.name = ? AND T.year = ? 
    """
    df = pd.read_sql_query(cmd, conn, params=(country, year))
    df = df.rename(columns= {"Name": "Country"})
    conn.close()
    fig = px.scatter(data_frame = df, # data that needs to be plotted
                 x = "Month", # column name for x-axis
                 y = "Temp", # column name for y-axis
                 color = "NAME", # column name for color coding
                 title = f"In {year},the temperature for each city in {country} "
                )
    return fig
fig = f(country = "Italy", year = 2020)
fig.show()
```
<div class = "display">
{% include g2.html %}
</div>



#### (2) The plot question: How has temperature changed between  two countries on a time period?


```python
def g(country_1, country_2, year_begin, year_end):
    conn = sqlite3.connect("temps.db")
    cmd = \
    """
    SELECT S.name, C.name , T.year,  T.temp, T.month
    FROM temperatures T
    LEFT JOIN stations S ON T.id = S.id
    LEFT JOIN countries C ON SUBSTRING(S.id,1,2) = C."fips_10-4"
    WHERE C.name = ? AND (T.year BETWEEN ? AND ?)
    """
    df_1 = pd.read_sql_query(cmd, conn, params=(country_1, year_begin, year_end))
    df_2 = pd.read_sql_query(cmd, conn, params=(country_2, year_begin, year_end))
    df = pd.concat([df_1,df_2], axis = 0)
    df = df.rename(columns= {"Name": "Country"})
    conn.close()
    df = df.groupby(["Year","Country"]).aggregate(np.mean)
    df = df.reset_index()
    fig = px.density_heatmap(df, 
                         x = "Year", 
                         y = "Temp",
                         facet_row = "Country",
                         nbinsx = 25,
                         nbinsy = 25)
    return fig
fig = g(country_1 = "Italy", country_2 = "Japan",year_begin = 1980, year_end = 2020)
fig.show()
```

<div class = "display">
{% include g3.html %}
</div>

From these two graph, we can see that the temperature is increasing as the time goes on. Although countries are different, the temperature is increasing in different countries. Therefore, we can conclude that the earth is warming.